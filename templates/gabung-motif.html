<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    {% load static %}
    <link rel="stylesheet" href="{% static 'style.css' %}" />
    <title>Modul Lidi</title>
    <link
      rel="icon"
      href="{% static 'img/icon/NewTitle.ico' %}"
      type="image/x-icon"
    />
    <style>
      /* Menyesuaikan ukuran gambar motif */
      .motif-size {
        width: 100%; /* Lebar gambar menyesuaikan lebar kontainer */
        height: auto; /* Menjaga rasio aspek gambar */
        object-fit: cover; /* Menjaga gambar tetap utuh dan tidak terpotong */
        margin-bottom: 10px; /* Menambahkan jarak antar gambar */
        position: relative; /* Agar angka bisa ditempatkan di posisi absolut */
      }

      /* Styling untuk angka yang ditampilkan di kiri atas gambar */
      .motif-number {
        position: absolute;
        top: 0px;
        left: 0px;
        background-color: blue; /* Warna biru */
        color: white; /* Warna teks putih */
        font-size: 14px; /* Ukuran font 14px */
        font-weight: bold;
        padding: 5px;
        border-radius: 0px; /* Membuat bentuk kotak */
        width: 20px; /* Lebar kotak */
        height: 20px; /* Tinggi kotak */
        display: flex;
        justify-content: center; /* Menyelaraskan teks ke tengah */
        align-items: center; /* Menyelaraskan teks ke tengah */
      }

      /* Styling untuk container Motif */
      .motif-container {
        margin-top: 0px;
        border: 2px solid #000000;
        border-radius: 8px;
        padding: 10px;
        background-color: #f5f5f5;
        height: 780px; /* Menambahkan tinggi agar kontainer setinggi kontainer lainnya */
      }

      /* Styling untuk judul container */
      .motif-container h5 {
        color: rgb(0, 0, 0);
        font-weight: bold;
      }

      /* Styling untuk container penggabungan motif */
      .combined-motif-container {
        min-height: 710px; /* Setel tinggi minimum agar konten tidak terpotong */
        max-height: 500px; /* Menetapkan tinggi maksimum */
        width: 100%;
        max-width: 500px;
        overflow-y: auto; /* Memungkinkan pengguliran jika konten lebih tinggi dari max-height */
        padding: 15px;
        background-color: white;
        border: 1px solid #ddd;
        position: relative;
        margin-top: 10px; /* Menambahkan jarak antar kontainer */
      }

      /* Card untuk Motif */
      .motif-card {
        margin-bottom: 5px;
        border: 2px solid #000000;
        border-radius: 0px;
        padding: 5px;
        background-color: #f9f9f9;
      }

      /* Styling untuk judul utama modul */
      .main-title {
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        margin-top: 0px;
        margin-bottom: 10px;
      }

      /* Menambahkan margin untuk tombol agar lebih ke bawah */
      .btn-container {
        margin-top: 40px; /* Menambahkan margin untuk memberi jarak lebih banyak ke bawah */
      }

      /* Menambahkan garis horizontal merah pada tengah container */
      .combined-motif-container::before {
        content: '';
        position: absolute;
        top: 50%; /* Menempatkan garis di tengah vertikal */
        left: 0;
        width: 100%; /* Garis memenuhi lebar container */
        height: 3px; /* Lebar garis */
        background-color: red; /* Warna merah */
        transform: translateY(-50%); /* Memastikan garis berada tepat di tengah */
      }
    </style>
  </head>

  <body>
    <div class="container card-0 justify-content-center">
      <div class="card-body px-sm-4 px-0">
        <!-- Judul Utama Modul Lidi -->
        <div class="row justify-content-center mb-5">
          <div class="col-md-10">
            <h3 class="main-title">Modul Lidi</h3>
            <p class="text-center text-white">
              Modul Lidi membantu penenun menghasilkan berbagai motif hanya
              dengan menggunakan sedikit Lidi. Motif yang dihasilkan telah
              teruji mampu menciptakan hingga ratusan motif dengan 8 jenis Lidi.
              Motif ini dapat diterapkan secara pasti pada kain tenun ulos.
            </p>
          </div>
        </div>

        <div class="row justify-content-center round">
          <div class="col-lg-10 col-md-12">
            <div class="card shadow-lg card-1">
              <div class="card-body inner-card">
                <div class="row">
                  <!-- Kolom untuk Menampilkan Motif Asal dan Hasil Motif -->
                  <div class="col-md-6 text-center">
                    <h5 class="motif-title">Motif</h5>
                    <p class="explanation-text">
                      Klik pada motif yang ingin dipilih. Anda dapat memilih
                      lebih dari satu motif untuk digabungkan dalam motif yang
                      sama.
                    </p>
                    <div class="motif-container">
                      <h5>Motif Asal</h5>
                      <div class="card motif-card">
                        <img
                          src="{{ raw_url }}"
                          class="card-img-top motif-size"
                          alt="Motif Asal"
                          onclick="addMotif(this)"
                        />
                      </div>

                      <h5>Hasil Motif 1</h5>
                      <div class="card motif-card">
                        <img
                          src="{{ edit_url }}"
                          class="card-img-top motif-size"
                          alt="Hasil Motif 1"
                          onclick="addMotif(this)"
                        />
                      </div>

                      <h5>Hasil Motif 2</h5>
                      <div class="card motif-card">
                        <img
                          src="{{ edit_url2 }}"
                          class="card-img-top motif-size"
                          alt="Hasil Motif 2"
                          onclick="addMotif(this)"
                        />
                      </div>

                      <h5>Hasil Motif 3</h5>
                      <div class="card motif-card">
                        <img
                          src="{{ edit_url3 }}"
                          class="card-img-top motif-size"
                          alt="Hasil Motif 3"
                          onclick="addMotif(this)"
                        />
                      </div>

                      <h5>Hasil Motif 4</h5>
                      <div class="card motif-card">
                        <img
                          src="{{ edit_url4 }}"
                          class="card-img-top motif-size"
                          alt="Hasil Motif 4"
                          onclick="addMotif(this)"
                        />
                      </div>
                    </div>
                  </div>

                  <!-- Kolom untuk Menampilkan Motif yang Digabungkan -->
                  <div class="col-md-6 text-center">
                    <h5 class="combined-title">Penggabungan Motif</h5>
                    <p class="explanation-text">
                      Jika Anda ingin menghapus motif yang telah dipilih, Anda dapat mengklik motif yang ingin dihapus.
                    </p>
                    <div class="motif-container">
                      <div id="combinedMotifContainer" class="combined-motif-container">
                        <p class="text-muted">Belum ada motif yang dipilih.</p>
                      </div>
                    </div>
                    <p class="text-muted" style="margin-top: 15px; text-align: center; margin-left: auto; margin-right: auto; word-wrap: break-word;">
                      Garis merah menunjukkan area cermin untuk menampilkan hasil desain yang simetris.
                    </p>
                  </div>
                </div>

                <!-- Tombol Simpan dan Ubah Warna, Letakkan di bawah dengan margin lebih besar -->
                <div class="btn-container row mt-4 text-center">
                  <div class="col-md-12">
                    <button
                      class="btn"
                      onclick="saveMotif()"
                      style="background-color: #002BA3; border: 2px solid #002BA3; border-radius: 0px; padding: 12px 30px 14px; font-size: 1.0rem; color: #FFFFFF; text-decoration: none; display: inline-block; width: 320px;"
                    >
                      Simpan Motif
                    </button>
                  </div>
                </div>

                <div class="btn-container row mt-4 text-center">
                  <div class="col-md-12">
                    <a
                      href="{% url 'ubah_warna' %}"
                      class="btn"
                      style="background-color: transparent; border: 2px solid #002BA3; border-radius: 0px; padding: 12px 30px 14px; font-size: 1.0rem; color: #002BA3; text-decoration: none; display: inline-block; width: 320px;"
                    >
                      Ubah Warna
                    </a>
                  </div>
                </div>

                <div class="btn-container row mt-4 text-center">
                  <div class="col-md-12">
                    <a
                      href="{% url 'generator' %}"
                      class="btn"
                      style="background-color: transparent; border: 2px solid #002BA3; border-radius: 0px; padding: 12px 30px 14px; font-size: 1.0rem; color: #002BA3; text-decoration: none; display: inline-block; width: 320px;"
                    >
                      Kembali
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

      <script>
        let motifCounter = 1; // Untuk melacak urutan gambar
      
        // Fungsi untuk menambahkan motif yang dipilih ke dalam container
        function addMotif(imageElement) {
          var combinedMotifContainer = document.getElementById("combinedMotifContainer");
      
          // Cek apakah ada pesan "Belum ada motif yang dipilih", jika ada, hapus
          if (combinedMotifContainer.innerHTML.includes("Belum ada motif yang dipilih")) {
            combinedMotifContainer.innerHTML = ''; // Hapus pesan tersebut
          }
      
          // Menentukan posisi berdasarkan urutan
          var numberOfMotifs = combinedMotifContainer.children.length / 2; // Menghitung jumlah motif yang ada
          var topPosition = `calc(50% - ${50 + (numberOfMotifs * 100)}px)`; // Menggeser gambar ke atas
          var bottomPosition = `calc(50% + ${50 + (numberOfMotifs * 100)}px)`; // Menggeser gambar ke bawah
      
          // Membuat elemen gambar pertama (untuk gambar baru)
          var img = document.createElement("img");
          img.src = imageElement.src;
          img.className = "motif-size";
          img.dataset.index = motifCounter; // Menambahkan atribut untuk urutan gambar
          img.onclick = function () {
            removeMotif(this);
          };
      
          // Membuat elemen angka untuk ditampilkan di gambar
          var numberLabel = document.createElement("span");
          numberLabel.className = "motif-number";
          numberLabel.textContent = motifCounter; // Menambahkan angka
      
          // Membuat elemen container untuk gambar pertama dan angka
          var imgContainer = document.createElement("div");
          imgContainer.style.position = "absolute"; // Menggunakan absolute positioning
          imgContainer.style.top = topPosition; // Menempatkan gambar pertama di atas
          imgContainer.style.left = "50%"; // Menempatkan gambar di tengah horizontal
          imgContainer.style.transform = "translateX(-50%)"; // Menjaga agar gambar tetap berada di tengah
          imgContainer.appendChild(img);
          imgContainer.appendChild(numberLabel);
      
          // Menambahkan gambar pertama ke dalam kontainer penggabungan
          combinedMotifContainer.appendChild(imgContainer);
      
          // Membuat elemen gambar kedua (untuk gambar baru)
          var imgDouble = document.createElement("img");
          imgDouble.src = imageElement.src;
          imgDouble.className = "motif-size";
          imgDouble.dataset.index = motifCounter; // Memberikan angka yang sama
          imgDouble.onclick = function () {
            removeMotif(this);
          };
      
          var numberLabelDouble = document.createElement("span");
          numberLabelDouble.className = "motif-number";
          numberLabelDouble.textContent = motifCounter; // Menambahkan angka yang sama untuk gambar kedua
      
          // Membuat elemen container untuk gambar kedua dan angka
          var imgContainerDouble = document.createElement("div");
          imgContainerDouble.style.position = "absolute"; // Menggunakan absolute positioning
          imgContainerDouble.style.top = bottomPosition; // Menempatkan gambar kedua di bawah
          imgContainerDouble.style.left = "50%"; // Menempatkan gambar di tengah horizontal
          imgContainerDouble.style.transform = "translateX(-50%)"; // Menjaga agar gambar tetap berada di tengah
          imgContainerDouble.appendChild(imgDouble);
          imgContainerDouble.appendChild(numberLabelDouble);
      
          // Menambahkan gambar kedua ke dalam kontainer penggabungan
          combinedMotifContainer.appendChild(imgContainerDouble);
      
          motifCounter++; // Menambah urutan gambar hanya 1 kali
        }
      
        // Fungsi untuk menghapus motif yang telah dipilih
        function removeMotif(motifElement) {
          motifElement.parentElement.remove();
        }
      
        // Fungsi untuk menyimpan motif
        function saveMotif() {
          // Logika untuk menyimpan motif, dapat diadaptasi
          alert("Motif disimpan!");
        }
      </script>
      
    </div>
  </body>
</html>